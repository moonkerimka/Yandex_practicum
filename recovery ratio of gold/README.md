## Моделирование процесса обогащения золотоносной руды

### Стек инструментов

Глубокая предобработка данных: соединение нескольких таблиц, заполнение пропусков, поиск выбросов и аномалий;  
Создание метрики SMAPE и применение ее в валидации моделей;  
Визуализация исходных данных, библиотеки matplotlib и seaborn;
Тестирование моделей библиотеки sklearn.

### Вводные данные

Горнодобывающая компания разрабатывает предиктивную модель обогащения руды. Алгоритм рассчитывает выход золота из сырья. 
Модель позволяет принимать на вход только богатое сырье на основании небольших проб.

### Цель проекта

Создать модель, предсказывающую содержание драгоценных металлов и шлака на различных этапах обогащения.

### Структура проекта  


 1. Подготовьте данные  
    1.1. Открыть и изучить данные;  
    1.2. Проверить правильность предварительных рассчетов;    
    1.3. Проанализировать признаки исходных данных;  
    1.4. Предобработать данные.  
 2. Исследовательский анализ данных  
    2.1. Изучить изменение концентрации металлов (Au, Ag, Pb) на различных этапах очистки;  
    2.2. Сравнить распределения размеров гранул сырья на обучающей и тестовой выборках;  
    2.3. Исследовать суммарную концентрацию веществ. Выделить и удалить аномалии.   
 3. Обучить и построить модели машинного обучения  
    3.1. Написать функцию для вычисления итоговой sMAPE;  
    3.2. Протестировать различные модели и выбрать лучшую по качеству и времени работы.  

 ### Общий вывод 
 Было проведено исследование, чтобы предсказать коэффициент восстановления золота из золотосодержащей руды.

Входные данные - данные с параметрами добычи и очистки.


В тестовой выборке меньше столбцов, чем в обучающей выборке, потому что отсутствующие столбцы явлются не определенными параметрами при начале технологического процесса и не могут находиться в тестовой выборке.


При заполнении пропусков применен KNNImputer.


На графиках представлены диаграммы размаха концентраций золота, серебра и свинца на разных технологических этапах. Наблюдается рост концентрации золота и свинца на каждом этапе, что говорит об эффективности этих процессов. Однако, концентрация серебра после этапа флотации снижается. Финальная концентрация золота и свинца примерно в 5,8 и 2,7 раза выше соответственно, чем концентрация в исходном сырье.


На обучающей и тестовой выборке размеры гранул сырья близки.


На обучающей выборке при построении диаграммы размаха наблюдается рост концентрации металлов при различных технологических этапах в 3 раза.


Были обучены модели линейной регрессии, дерева решений и случайного леса.
Какая модель лучше?
У каждой — свои достоинства и недостатки.
У алгоритма классификации - случайный лес, высокое качество (accuracy), но медленная скорость.
У дерева решений, качество (accuracy) ниже, чем у случайного леса, но высокая скорость работы.
У линейной регрессии самое низкое качество (accuracy), но высокая скорость работы.


Финальные параметры выбранной модели RandomForestClassifier(random_state=12345, n_estimators=10, max_depth=2).


Проведена проверка финальной модели тестовой выборкой.
