## Прогнозирование оттока клиентов банка

### Стек инструментов
Работа с дисбалансом классов;  
Изучение и применение метрик классификации (f1, ROC-AUC, confusion matrix);  
Изучение и применение метрик регрессии (RMSE, MAE, R2).

### Вводные данные
Банк заметил отток клиентов. Маркетологи выяснили, что дешевле сохранить имеющихся клиентов, чем привлекать новых.

### Цель

Создать модель для предсказания выхода клиента из обслуживания банком.
Имеются размеченные данные: история клиентов и информация о лояльности.

### Структура проекта  

 1. Импорт библиотек и данных;
 2. Предобработка данных, разбивка на три выборки;
 3. Исследование баланса классов, обучение модели без учета дисбаланса;
 4. Улучшение модели, балансировка классов, тестирование разных моделей, выбор лучшей;
 5. Финальное тестирование модели;
 6. Анализ полученных данных и написание выводов. 
### Общий вывод



Было проведено исследование, чтобы построить модель, уйдёт клиент из банка «Бета-Банка» в ближайшее время или нет, с предельно большим значением F1 меры.

Входные данные - исторические данные о поведении клиентов и расторжении договоров с банком.


Были обучены модели логистической регрессии, дерева решений и случайного леса.
Какая модель лучше?
У каждой — свои достоинства и недостатки.
У алгоритма классификации - случайный лес, высокое качество (accuracy), но медленная скорость.
У дерева решений, качество (accuracy) ниже, чем у случайного леса, но высокая скорость работы.
У логистической регресии самое низкое качество (accuracy), но высокая скорость работы.


Про проверки моделей на адекватность в сравнении с контантной моделью, худший результат показала логистическая регресия.


Для улучшения метрик качества моделей применены техники взвешивания классов, upsampling и downsampling. После их применения была найдена лучшая модель RandomForestClassifier с увеличенной выборкой.


Финальные параметры выбранной модели RandomForestClassifier(random_state=12345, n_estimators=40, max_depth=17).


Проведена проверка финальной модели тестовой выборкой.
